<!-- ********************************************************************** -->
<!--                                                                        -->
<!--  test_codebase_erb.txt                             TTTTTTTT SSSSSSS II -->
<!--                                                       TT    SS      II -->
<!--  By: st93642@students.tsi.lv                          TT    SSSSSSS II -->
<!--                                                       TT         SS II -->
<!--  Created: Sep 29 2025 14:28 st93642                   TT    SSSSSSS II -->
<!--  Updated: Sep 29 2025 14:28 st93642                                    -->
<!--                                                                        -->
<!--   Transport and Telecommunication Institute - Riga, Latvia             -->
<!--                       https://tsi.lv                                   -->
<!-- ********************************************************************** -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TSI Header - ERB Template Example</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            line-height: 1.6;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .user-info {
            background-color: #e8f5e8;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .posts {
            margin: 20px 0;
        }
        .post {
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .error {
            color: #d9534f;
            background-color: #f2dede;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Welcome to TSI ERB Template</h1>
            <p>Transport and Telecommunication Institute - Riga, Latvia</p>
        </header>

        <main>
            <!-- User greeting with conditional rendering -->
            <% if @user %>
                <div class="user-info">
                    <h2>Hello, <%= @user.name %>!</h2>
                    <p>Email: <%= @user.email %></p>
                    <p>Member since: <%= @user.created_at.strftime('%B %Y') %></p>
                    <% if @user.admin? %>
                        <span class="badge">Administrator</span>
                    <% end %>
                </div>
            <% else %>
                <div class="user-info">
                    <h2>Welcome, Guest!</h2>
                    <p>Please <a href="/login">log in</a> to access your account.</p>
                </div>
            <% end %>

            <!-- Posts listing with loop -->
            <section class="posts">
                <h2>Recent Posts</h2>
                <% if @posts && @posts.any? %>
                    <% @posts.each do |post| %>
                        <article class="post">
                            <h3><%= post.title %></h3>
                            <p class="meta">
                                By <%= post.author.name %> on <%= post.created_at.strftime('%B %d, %Y') %>
                                <% if post.tags.any? %>
                                    | Tags: <%= post.tags.map(&:name).join(', ') %>
                                <% end %>
                            </p>
                            <div class="content">
                                <%= truncate(post.content, length: 200) %>
                                <% if post.content.length > 200 %>
                                    <a href="<%= post_path(post) %>">Read more...</a>
                                <% end %>
                            </div>
                            <div class="actions">
                                <%= link_to 'View', post_path(post) %>
                                <% if can?(:edit, post) %>
                                    | <%= link_to 'Edit', edit_post_path(post) %>
                                <% end %>
                                <% if can?(:destroy, post) %>
                                    | <%= link_to 'Delete', post_path(post),
                                                  method: :delete,
                                                  data: { confirm: 'Are you sure?' } %>
                                <% end %>
                            </div>
                        </article>
                    <% end %>

                    <!-- Pagination -->
                    <% if @posts.total_pages > 1 %>
                        <div class="pagination">
                            <%= paginate @posts %>
                        </div>
                    <% end %>
                <% else %>
                    <p>No posts found.</p>
                <% end %>
            </section>

            <!-- Form example -->
            <section class="new-post">
                <h2>Create New Post</h2>
                <%= form_with model: @post, local: true do |form| %>
                    <% if @post.errors.any? %>
                        <div class="error">
                            <h3><%= pluralize(@post.errors.count, "error") %> prohibited this post from being saved:</h3>
                            <ul>
                                <% @post.errors.full_messages.each do |message| %>
                                    <li><%= message %></li>
                                <% end %>
                            </ul>
                        </div>
                    <% end %>

                    <div class="field">
                        <%= form.label :title %>
                        <%= form.text_field :title, required: true %>
                    </div>

                    <div class="field">
                        <%= form.label :content %>
                        <%= form.text_area :content, rows: 10, required: true %>
                    </div>

                    <div class="field">
                        <%= form.label :tags %>
                        <%= form.text_field :tags, placeholder: "Comma-separated tags" %>
                    </div>

                    <div class="field">
                        <%= form.label :published %>
                        <%= form.check_box :published %>
                    </div>

                    <div class="actions">
                        <%= form.submit "Create Post" %>
                    </div>
                <% end %>
            </section>

            <!-- Navigation menu -->
            <nav>
                <ul>
                    <li><%= link_to 'Home', root_path %></li>
                    <li><%= link_to 'About', about_path %></li>
                    <li><%= link_to 'Contact', contact_path %></li>
                    <% if @user %>
                        <li><%= link_to 'Profile', profile_path %></li>
                        <li><%= link_to 'Logout', logout_path, method: :delete %></li>
                    <% else %>
                        <li><%= link_to 'Login', login_path %></li>
                        <li><%= link_to 'Sign Up', signup_path %></li>
                    <% end %>
                </ul>
            </nav>

            <!-- Flash messages -->
            <% flash.each do |key, message| %>
                <div class="flash <%= key %>">
                    <%= message %>
                </div>
            <% end %>

            <!-- Partial includes -->
            <%= render 'shared/sidebar' %>
            <%= render 'shared/footer' %>
        </main>

        <footer>
            <p>&copy; <%= Time.current.year %> Transport and Telecommunication Institute. All rights reserved.</p>
            <p>Powered by Ruby on Rails with ERB templates</p>
        </footer>
    </div>

    <!-- JavaScript with ERB -->
    <script>
        // ERB can also be used in JavaScript
        var userId = <%= @user&.id || 'null' %>;
        var postsCount = <%= @posts&.count || 0 %>;

        <% if @user %>
            console.log('Logged in as: <%= j @user.name %>');
        <% else %>
            console.log('User not logged in');
        <% end %>

        // Dynamic content based on Ruby variables
        <% @posts.each do |post| %>
            console.log('Post: <%= j post.title %>');
        <% end %>
    </script>
</body>
</html>

<!-- Additional ERB Examples -->

<!-- 1. Simple variable interpolation -->
<!-- <p>Welcome, <%= @user.name %>!</p> -->

<!-- 2. Conditional rendering -->
<!-- <% if @user.admin? %> -->
<!--     <div>Admin Panel</div> -->
<!-- <% else %> -->
<!--     <div>User Panel</div> -->
<!-- <% end %> -->

<!-- 3. Loops -->
<!-- <% @items.each do |item| %> -->
<!--     <li><%= item.name %></li> -->
<!-- <% end %> -->

<!-- 4. Safe output (HTML escaped) -->
<!-- <%= @user.comment %> -->

<!-- 5. Unsafe output (raw HTML) -->
<!-- <%== @user.comment %> -->

<!-- 6. Comments (not rendered) -->
<!-- <%# This is a comment %> -->

<!-- 7. Code execution without output -->
<!-- <% @counter ||= 0 %> -->
<!-- <% @counter += 1 %> -->

<!-- 8. Collection rendering -->
<!-- <%= render partial: 'item', collection: @items %> -->

<!-- 9. Form helpers -->
<!-- <%= form_for @user do |f| %> -->
<!--     <%= f.text_field :name %> -->
<!--     <%= f.submit %> -->
<!-- <% end %> -->

<!-- 10. Link helpers -->
<!-- <%= link_to 'Edit', edit_user_path(@user) %> -->

<!-- 11. Asset helpers -->
<!-- <%= stylesheet_link_tag 'application' %> -->
<!-- <%= javascript_include_tag 'application' %> -->
<!-- <%= image_tag 'logo.png' %> -->

<!-- 12. URL helpers -->
<!-- <%= users_path %> -->
<!-- <%= user_path(@user) %> -->

<!-- 13. Number helpers -->
<!-- <%= number_to_currency(@price) %> -->
<!-- <%= number_with_delimiter(@count) %> -->

<!-- 14. Date/Time helpers -->
<!-- <%= time_ago_in_words(@post.created_at) %> -->
<!-- <%= @post.created_at.strftime('%B %d, %Y') %> -->

<!-- 15. Text helpers -->
<!-- <%= truncate(@text, length: 100) %> -->
<!-- <%= pluralize(@count, 'item') %> -->
<!-- <%= simple_format(@text) %> -->
